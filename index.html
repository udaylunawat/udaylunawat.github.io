<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uday Lunawat - Portfolio</title>
    <link rel="stylesheet" href="src/style.css">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;200;300;400;500;600;700;800;900&family=Oswald:wght@200;300;400;500;600;700&family=Roboto+Mono:ital,wght@0,100;0,200;0,300;0,400;1,100;1,200;1,300;1,400&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/devicons/devicon@v2.15.1/devicon.min.css">
</head>

<body>
<div id="particles-js"></div>
    <div class="canvas-container" id="canvas">
    <canvas></canvas>
</div>

<div class="color-background" id="colorBackground">
</div>

<!-- Minimal Particles Control Panel Toggle Button -->
<button id="particles-control-toggle" class="particles-control-toggle-btn" title="Particles Controls">
  ✨
</button>

<!-- Minimal Particles Control Panel with Tabs -->
<div id="particles-control-panel" class="particles-control-panel hidden">
  <div class="particles-panel-header">
    <h3>🎮 Controls</h3>
    <button id="particles-panel-close" class="particles-panel-close">&times;</button>
  </div>

  <!-- Tab Navigation -->
  <div class="control-tabs">
    <button id="particles-tab" class="control-tab active" data-tab="particles">✨ Particles</button>
    <button id="background-tab" class="control-tab" data-tab="background">🌊 Background</button>
  </div>

  <!-- Particles Tab Content -->
  <div id="particles-content" class="particles-panel-content control-tab-panel active">
    <div class="control-group">
      <label>Particle Count</label>
      <div class="single-control">
        <input type="range" id="particles-number" min="1" max="100" value="15" step="1">
        <span id="particles-number-display" class="value-display">15</span>
      </div>
    </div>

    <div class="control-group">
      <label>Particle Speed</label>
      <div class="single-control">
        <input type="range" id="particles-speed" min="0.5" max="10" value="3" step="0.5">
        <span id="particles-speed-display" class="value-display">3</span>
      </div>
    </div>

    <div class="control-group">
      <label>Particle Size</label>
      <div class="single-control">
        <input type="range" id="particles-size" min="2" max="20" value="8" step="1">
        <span id="particles-size-display" class="value-display">8</span>
      </div>
    </div>

    <div class="control-group">
      <label>Particle Opacity</label>
      <div class="single-control">
        <input type="range" id="particles-opacity" min="0.1" max="1.0" value="1.0" step="0.05">
        <span id="particles-opacity-display" class="value-display">1.0</span>
      </div>
    </div>

    <div class="control-group">
      <label>Link Opacity</label>
      <div class="single-control">
        <input type="range" id="particles-link-opacity" min="0.1" max="1.0" value="0.4" step="0.05">
        <span id="particles-link-opacity-display" class="value-display">0.4</span>
      </div>
    </div>

    <div class="control-group">
      <label>Particle Color</label>
      <div class="single-control color-control">
        <input type="color" id="particles-color" value="#ffffff" class="color-picker">
        <span id="particles-color-display" class="value-display">#ffffff</span>
      </div>
    </div>
  </div>

  <!-- Background Tab Content -->
  <div id="background-content" class="particles-panel-content control-tab-panel">
    <div class="control-info">
      <p>🎨 Background animation controls</p>
    </div>

    <div class="control-group">
      <label>Animation Speed</label>
      <div class="single-control">
        <input type="range" id="background-speed" min="0.001" max="0.5" value="0.01" step="0.001">
        <span id="background-speed-display" class="value-display">0.01</span>
      </div>
    </div>

    <div class="control-group">
      <label>Distortion</label>
      <div class="single-control">
        <input type="range" id="background-distortion" min="0" max="100" value="35" step="1">
        <span id="background-distortion-display" class="value-display">35</span>
      </div>
    </div>

    <div class="control-group">
      <label>Wave Frequency</label>
      <div class="single-control">
        <input type="range" id="background-frequency" min="0.5" max="2.0" value="1.0" step="0.1">
        <span id="background-frequency-display" class="value-display">1.0</span>
      </div>
    </div>

    <div class="control-group">
      <label>Animation Phase</label>
      <div class="single-control">
        <input type="range" id="background-phase" min="0" max="6.28" value="0" step="0.1">
        <span id="background-phase-display" class="value-display">0</span>
      </div>
    </div>
  </div>
</div>

<nav class="main-nav" id="menu">
    <img class="nav-close-icon" id="close-icon" src="./src/img/close-icon.svg" alt="" onclick="hideMenu()">
    <ul>
        <li><a href="#homeTitle" onclick="hideMenu()">Home</a></li>
        <li><a href="#about" onclick="hideMenu()">About</a></li>
        <li><a href="#credentials" onclick="hideMenu()">Experience</a></li>
        <li><a href="#skills" onclick="hideMenu()">Skills</a></li>
        <li><a href="#projects" onclick="hideMenu()">Projects</a></li>
        <li><a href="#contact" onclick="hideMenu()">CONTAct /<span>resume</span></a></li>
    </ul>
</nav>

<!----------- HOME -------->

<header class="home" id="homeTitle">
    <div class="wrapper">
      <div class="home-grid">
        <h4 id="homeTitle1">Loading...</h4>
        <svg width="18.75rem" height="6.25rem">
          <line x1="9.375rem" y1="6.25rem" x2="9.375rem" y2="0" stroke="#ffffff37"/>
          <line x1="6.25rem" y1="3.125rem" x2="12.5rem" y2="3.125rem" stroke="#ffffff37"/>
        </svg>
        <h4 id="homeTitle2">Loading...</h4>
      </div>
      <h2 id="homeName">Uday Lunawat</h2>
      <p class="tagline">Loading...</p>
    </div>
  </header>

<!--------- ABOUT ---------->

<section class="about" id="about">
    <div class="wrapper">
      <div class="text-box">
        <h2>
          <img src="./src/img/icon-rocket.svg" alt="Rocket icon">
          Passion
        </h2>
        <p>
          Loading...
        </p>
      </div>
    </div>
  </section>

  <section class="credentials" id="credentials">
    <div class="wrapper">
      <h2>Experience</h2>

      <!-- Experience Gallery -->
      <div class="experience-gallery">
        <div class="gallery-container">
          <div class="gallery-grid" id="experience-gallery-grid">
            <!-- Content will be loaded dynamically from content.json -->
          </div>
        </div>
      </div>
    </div>
  </section>

<!--------- SKILLS ---------->

<section class="skills" id="skills">
    <h2>Skills</h2>
    <div class="wrapper grid">
      <!-- Content will be loaded dynamically from content.json -->
    </div>
</section>

<!-------- PROJECTS -------->

<section class="projects" id="projects">
    <div class="wrapper">
      <h2>Projects</h2>

      <!-- Infinite Scroll Gallery -->
      <div class="infinite-gallery">
        <div class="gallery-container">
          <div class="gallery-grid" id="gallery-grid">
            <!-- Content will be loaded dynamically from projects.json -->
          </div>
        </div>

        <!-- Loading indicator -->
        <div class="loading-indicator" id="loading-indicator">
          <div class="loading-spinner"></div>
          <p>Loading more projects...</p>
        </div>
      </div>
    </div>
  </section>

<!------------ CONTACT ------------->

<section class="contact" id="contact">
    <h2>Contact</h2>
    <div class="wrapper">
      <div class="flex-container">
        <div class="flex-container">
          <div class="img-container">
            <img src="loading.jpg" alt="Loading..." class="profile-photo">
          </div>
          <div class="contact-col">
            <p>
              Loading...
            </p>
            <div class="flex-container">
              <a href="#"><button class="secondary-btn">Loading...</button></a>
              <a href="#"><button class="secondary-btn">Loading...</button></a>
              <a href="#"><button class="secondary-btn">Loading...</button></a>
            </div>

            <div style="margin-top:12px;">
              <a href="#" id="resume-link">
                <button>
                  DOWNLOAD RESUME
                  <img src="./src/img/pdf-icon.svg" alt="">
                </button>
              </a>
            </div>
          </div>
        </div>

        <div class="contact-form-container contact-col">
          <h4>Loading...</h4>
          <div class="contact-form">
            <form
            action="https://formspree.io/f/mvgbvdbq"
            method="POST"
          >
            <label>
              Your email:
              <input type="email" name="email">
            </label>
            <label>
              Your message:
              <textarea name="message"></textarea>
            </label>
            <!-- your other form fields go here -->
            <button type="submit">Send</button>
          </form>
          </div>
        </div>

      </div>
    </div>
  </section>

<!------------ FOOTER ------------->

<!-- <section class="footer">
</section> -->

<!-- Modal system integrated -->
<div id="project-modal" class="modal-overlay">
  <div class="modal-content">
    <div class="modal-content-wrapper">
      <div class="modal-header">
        <div class="modal-header-content">
          <h1 id="modal-title">Project Title</h1>
          <div class="tags" id="modal-tags"></div>
        </div>
      </div>
      <div class="modal-body">
        <div id="modal-content-container" class="blog-content">
          <!-- Project content will be loaded here -->
        </div>
      </div>
    </div>
  </div>
</div>

<div id="experience-modal" class="modal-overlay">
  <div class="modal-content">
    <div class="modal-content-wrapper">
      <div class="modal-header">
        <div class="modal-header-content">
          <h1 id="experience-modal-title">Experience Title</h1>
          <div class="tags" id="experience-modal-tags"></div>
        </div>
      </div>
      <div class="modal-body">
        <div id="experience-modal-content-container" class="blog-content">
          <!-- Experience content will be loaded here -->
        </div>
      </div>
    </div>
  </div>
</div>

<!------------ NAVIGATION ------------->

<img class="nav-open-icon" id="open-icon" src="./src/img/menu-icon.svg" alt="" onclick="showMenu()">

<script src="./src/navigation.js" type="module"></script>
<script src="./src/modals.js" type="module"></script>
<script src="./src/scroll-animations.js" type="module"></script>

<!-- Core dependencies -->
<script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js"></script>

<!-- Shaders for animated background (required by background.js) -->
<script id="snoise-function" type="x-shader/x-vertex">
    vec3 mod289(vec3 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }
    vec2 mod289(vec2 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }
    vec3 permute(vec3 x) { return mod289(((x*34.0)+1.0)*x); }

    float snoise(vec2 v) {
        const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0
                            0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)
                            -0.577350269189626,  // -1.0 + 2.0 * C.x
                            0.024390243902439); // 1.0 / 41.0
        vec2 i  = floor(v + dot(v, C.yy) );
        vec2 x0 = v -   i + dot(i, C.xx);
        vec2 i1;
        i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
        vec4 x12 = x0.xyxy + C.xxzz;
        x12.xy -= i1;
        i = mod289(i); // Avoid truncation effects in permutation
        vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))
            + i.x + vec3(0.0, i1.x, 1.0 ));

        vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);
        m = m*m ;
        m = m*m ;
        vec3 x = 2.0 * fract(p * C.www) - 1.0;
        vec3 h = abs(x) - 0.5;
        vec3 ox = floor(x + 0.5);
        vec3 a0 = x - ox;
        m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );
        vec3 g;
        g.x  = a0.x  * x0.x  + h.x  * x0.y;
        g.yz = a0.yz * x12.xz + h.yz * x12.yw;
        return 130.0 * dot(m, g);
    }
</script>
<script id="vertex-shader" type="x-shader/x-vertex">
    uniform float u_time;
    uniform vec2 u_randomisePosition;
    uniform float u_distortion;

    varying float vDistortion;
    varying float xDistortion;
    varying vec2 vUv;

    void main() {
        vUv = uv;
        vDistortion = snoise(vUv.xx * u_distortion * 0.3 - u_randomisePosition * 0.15);
        xDistortion = snoise(vUv.yy * u_distortion * 0.1 - u_randomisePosition * 0.05);
        vec3 pos = position;
        pos.z += (vDistortion * u_distortion * 3.5);
        pos.x += (xDistortion * u_distortion * 2.5);

        gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
    }
</script>
<script id="fragment-shader" type="x-shader/x-fragment">
    vec3 rgb(float r, float g, float b) {
        return vec3(r / 255., g / 255., b / 255.);
    }

    vec3 rgb(float c) {
        return vec3(c / 255., c / 255., c / 255.);
    }

    uniform vec3 u_bg;
    uniform vec3 u_bgMain;
    uniform vec3 u_color1;
    uniform vec3 u_color2;
    uniform float u_time;

    varying vec2 vUv;
    varying float vDistortion;

    void main() {
        vec3 bg = rgb(u_bg.r, u_bg.g, u_bg.b);
        vec3 c1 = rgb(u_color1.r, u_color1.g, u_color1.b);
        vec3 c2 = rgb(u_color2.r, u_color2.g, u_color2.b);
        vec3 bgMain = rgb(u_bgMain.r, u_bg.g, u_bg.b);

        float noise1 = snoise(vUv + u_time * 0.08);
        float noise2 = snoise(vUv * 2. + u_time * 0.1);

        vec3 color = bg;
        color = mix(color, c1, noise1 * 0.6);
        color = mix(color, c2, noise2 * .4);

        color = mix(color, mix(c1, c2, vUv.x), vDistortion);

        float border = smoothstep(0.1, 0.6, vUv.x);

        color = mix(color, bgMain, 1. -border);

        gl_FragColor = vec4(color, 1.0);
    }
</script>

<script src="./src/background.js" type="module"></script>
<script src="./src/content-loader.js"></script>

<!---- JavaScript for scrolling to sections smoothly ---->
<script>
document.addEventListener("DOMContentLoaded", function() {
  // Smooth scrolling for anchor links
  const smoothScrollLinks = document.querySelectorAll("a[href^='#']");
  const scrollMargin = 0;

  smoothScrollLinks.forEach(function(link) {
    link.addEventListener("click", function(e) {
      e.preventDefault();
      const target = document.querySelector(this.hash);
      if (target) {
        const targetOffset = target.offsetTop;
        window.scrollTo({
          top: targetOffset - scrollMargin,
          behavior: "smooth",
        });
      }
    });
  });
});
</script>

<!-- Particles configuration -->
<script>
particlesJS("particles-js", {
  "particles": {
    "number": { "value": 15 },
    "color": { "value": "#ffffff" },
    "shape": { "type": "circle" },
    "opacity": {
      "value": 1.0,
      "random": true,
      "anim": {
        "enable": true,
        "speed": 1.5,
        "opacity_min": 0.3,
        "sync": false
      }
    },
    "size": {
      "value": 8,
      "random": true,
      "anim": {
        "enable": true,
        "speed": 3,
        "size_min": 2,
        "sync": false
      }
    },
    "line_linked": {
      "enable": true,
      "distance": 300,
      "color": "#ffffff",
      "opacity": 0.4,
      "width": 1,
      "path": { "enable": true, "type": "particles" }
    },
    "move": {
      "enable": true,
      "speed": 3,
      "direction": "none",
      "random": false,
      "straight": false,
      "out_mode": "out",
      "bounce": false,
      "attract": { "enable": false, "rotateX": 600, "rotateY": 1200 }
    },
    "twinkle": {
      "lines": {
        "enable": true,
        "frequency": 0.5,
        "opacity": 1.0,
        "color": "#ffffff",
        "wave": {
          "travel": false,
          "speed": 0.5
        }
      },
      "particles": {
        "enable": true,
        "frequency": 0.3,
        "opacity": 1.0,
        "color": "#ffffff",
        "wave": {
          "travel": false,
          "speed": 0.8
        }
      }
    }
  },
  "interactivity": {
    "events": {
      "onhover": { "enable": true, "mode": "bubble", "duration": 0.1 },
      "onclick": { "enable": true, "mode": "push" }
    },
    "modes": {
      "bubble": {
        "distance": 100,
        "size": 30,
        "duration": 2,
        "opacity": 1.0
      }
    }
  },
  "retina_detect": true
});
</script>

<!-- Live GitHub stars fetcher -->
<script>
const repoMap = {
  "Automatic-License-Plate-Recognition": "Automatic-License-Plate-Recognition",
  "Covid-19-Radiology": "Covid-19-Radiology",
  "Data-Science-Projects": "Data-Science-Projects"
};

async function fetchRepo(owner, repo) {
  const url = `https://api.github.com/repos/${owner}/${repo}`;
  try {
    const r = await fetch(url);
    if (!r.ok) return null;
    return r.json();
  } catch (e) {
    return null;
  }
}

async function updateStars() {
  const owner = "udaylunawat";
  const seen = {};
  for (const key in repoMap) {
    const repo = repoMap[key];
    if (seen[repo]) {
      const data = seen[repo];
      updateDomForKey(key, data);
      continue;
    }
    const data = await fetchRepo(owner, repo);
    seen[repo] = data;
    updateDomForKey(key, data);
  }
}

function updateDomForKey(key, data) {
  const elIdMap = {
    "Automatic-License-Plate-Recognition": "stats-Automatic-License-Plate-Recognition",
    "Covid-19-Radiology": "stats-Covid-19-Radiology",
    "Data-Science-Projects": "stats-Data-Science-Projects"
  };
  const elId = elIdMap[key];
  const el = document.getElementById(elId);
  if (!el) return;
  if (!data) {
    el.textContent = '⭐ — · 🍴 —';
    return;
  }
  const stars = data.stargazers_count ?? 0;
  const forks = data.forks_count ?? 0;
  el.textContent = `⭐ ${stars} · 🍴 ${forks}`;
}

document.addEventListener('DOMContentLoaded', () => {
  updateStars().catch(()=>{});
});
</script>

<!-- Consolidated control panel with full functionality -->
<script>
document.addEventListener('DOMContentLoaded', function() {
  console.log('🎮 Initializing enhanced particles control panel with tabs...');

  // Elements
  const toggleBtn = document.getElementById('particles-control-toggle');
  const controlPanel = document.getElementById('particles-control-panel');
  const closeBtn = document.getElementById('particles-panel-close');

  // Tab elements
  const particlesTab = document.getElementById('particles-tab');
  const backgroundTab = document.getElementById('background-tab');
  const particlesContent = document.getElementById('particles-content');
  const backgroundContent = document.getElementById('background-content');

  // Particles sliders and displays
  const numberSlider = document.getElementById('particles-number');
  const numberDisplay = document.getElementById('particles-number-display');
  const speedSlider = document.getElementById('particles-speed');
  const speedDisplay = document.getElementById('particles-speed-display');
  const sizeSlider = document.getElementById('particles-size');
  const sizeDisplay = document.getElementById('particles-size-display');
  const linkOpacitySlider = document.getElementById('particles-link-opacity');
  const linkOpacityDisplay = document.getElementById('particles-link-opacity-display');
  const opacitySlider = document.getElementById('particles-opacity');
  const opacityDisplay = document.getElementById('particles-opacity-display');
  const backgroundSpeedSlider = document.getElementById('background-speed');
  const backgroundSpeedDisplay = document.getElementById('background-speed-display');
  const backgroundDistortionSlider = document.getElementById('background-distortion');
  const backgroundDistortionDisplay = document.getElementById('background-distortion-display');
  const backgroundPhaseSlider = document.getElementById('background-phase');
  const backgroundPhaseDisplay = document.getElementById('background-phase-display');
  const backgroundFrequencySlider = document.getElementById('background-frequency');
  const backgroundFrequencyDisplay = document.getElementById('background-frequency-display');

  // Toggle panel visibility
  function toggleControlPanel() {
    if (controlPanel.classList.contains('hidden')) {
      showControlPanel();
    } else {
      hideControlPanel();
    }
  }

  function showControlPanel() {
    controlPanel.classList.remove('hidden');
    console.log('✨ Particles control panel shown');
  }

  function hideControlPanel() {
    controlPanel.classList.add('hidden');
    console.log('✨ Particles control panel hidden');
  }

  // Tab switching functionality
  function switchTab(targetTab) {
    console.log('🔄 Switching to tab:', targetTab);

    // Remove active state from all tabs and panels
    [particlesTab, backgroundTab].forEach(tab => tab.classList.remove('active'));
    [particlesContent, backgroundContent].forEach(panel => panel.classList.remove('active'));

    // Add active state to targeted tab and panel
    if (targetTab === 'particles') {
      particlesTab.classList.add('active');
      particlesContent.classList.add('active');
      console.log('✨ Switched to Particles tab');
    } else if (targetTab === 'background') {
      backgroundTab.classList.add('active');
      backgroundContent.classList.add('active');
      console.log('🌊 Switched to Background tab');
    }
  }

  // Initialize particles controls
  function initializeParticlesControls() {
    if (window.pJSDom && window.pJSDom.length > 0) {
      // Set initial display values
      if (window.pJSDom[0].pJS && window.pJSDom[0].pJS.particles) {
        const pJS = window.pJSDom[0].pJS;
        if (numberDisplay) numberDisplay.textContent = pJS.particles.number.value;
        if (speedDisplay) speedDisplay.textContent = pJS.particles.move.speed;
        if (sizeDisplay) sizeDisplay.textContent = pJS.particles.size.value;
        if (linkOpacityDisplay) linkOpacityDisplay.textContent = pJS.particles.line_linked.opacity;
        if (opacityDisplay) opacityDisplay.textContent = pJS.particles.opacity.value;
        console.log('✨ Particles controls initialized successfully');
        return true;
      }
    }
    return false;
  }

  // Update particles parameter
  function updateParticlesParameter(parameter, value) {
    if (window.pJSDom && window.pJSDom.length > 0) {
      const pJS = window.pJSDom[0].pJS;

      // Update the parameter in the particles configuration
      switch(parameter) {
        case 'number':
          if (numberSlider) numberSlider.value = value;
          if (numberDisplay) numberDisplay.textContent = value;
          break;
        case 'speed':
          if (speedSlider) speedSlider.value = value;
          if (speedDisplay) speedDisplay.textContent = value;
          break;
        case 'size':
          if (sizeSlider) sizeSlider.value = value;
          if (sizeDisplay) sizeDisplay.textContent = value;
          break;
        case 'linkOpacity':
          if (linkOpacitySlider) linkOpacitySlider.value = value;
          if (linkOpacityDisplay) linkOpacityDisplay.textContent = value;
          break;
      }

      // Reinitialize particles.js with updated configuration
      const updatedConfig = {
        particles: {
          number: { value: parseInt(numberSlider ? numberSlider.value : 15) },
          color: { value: "#ffffff" },
          shape: { type: "circle" },
          opacity: {
            value: parseFloat(opacitySlider ? opacitySlider.value : 1.0),
            random: true,
            anim: {
              enable: true,
              speed: 1.5,
              opacity_min: 0.3,
              sync: false
            }
          },
          size: {
            value: parseInt(sizeSlider ? sizeSlider.value : 8),
            random: true,
            anim: {
              enable: true,
              speed: 3,
              size_min: 2,
              sync: false
            }
          },
          line_linked: {
            enable: true,
            distance: 300,
            color: "#ffffff",
            opacity: parseFloat(linkOpacitySlider ? linkOpacitySlider.value : 0.4),
            width: 1,
            path: { enable: true, type: "particles" }
          },
          move: {
            enable: true,
            speed: parseFloat(speedSlider ? speedSlider.value : 3),
            direction: "none",
            random: false,
            straight: false,
            out_mode: "out",
            bounce: false,
            attract: { enable: false, rotateX: 600, rotateY: 1200 }
          }
        },
        interactivity: {
          events: {
            onhover: {
              enable: true,
              mode: "bubble",
              duration: 0.1
            },
            onclick: {
              enable: true,
              mode: "push"
            }
          },
          modes: {
            bubble: {
              distance: 100,
              size: 30,
              duration: 2,
              opacity: 1.0
            }
          }
        },
        retina_detect: true
      };

      // Destroy existing particles and reinitialize
      if (window.pJSDom[0].pJS.fn && window.pJSDom[0].pJS.fn.particlesEmpty) {
        window.pJSDom[0].pJS.fn.particlesEmpty();
        if (typeof particlesJS === 'function') {
          particlesJS("particles-js", updatedConfig);
        }
      }

      console.log(`✨ Particles ${parameter} updated to:`, value, 'Full config reloaded');
    } else {
      console.log('⚠️ Particles.js not ready yet, cannot update');
      // Update display anyway for consistency
      switch(parameter) {
        case 'number':
          if (numberDisplay) numberDisplay.textContent = value;
          break;
        case 'speed':
          if (speedDisplay) speedDisplay.textContent = value;
          break;
        case 'size':
          if (sizeDisplay) sizeDisplay.textContent = value;
          break;
        case 'linkOpacity':
          if (linkOpacityDisplay) linkOpacityDisplay.textContent = value;
          break;
      }
    }
  }

  // Update background parameter
  function updateBackgroundParameter(parameter, value) {
    if (window.backgroundControls) {
      try {
        switch(parameter) {
          case 'speed':
            window.backgroundControls.setAnimationSpeed(value, undefined);
            if (backgroundSpeedDisplay) backgroundSpeedDisplay.textContent = value;
            console.log(`🌊 Background animation speed updated to:`, value);
            break;
          case 'distortion':
            window.currentDistortion = value / 100.0;
            if (backgroundDistortionDisplay) backgroundDistortionDisplay.textContent = value;
            console.log(`🌊 Background distortion updated to:`, value);
            if (window.backgroundControls.updateBackgroundDistortion) {
              window.backgroundControls.updateBackgroundDistortion(window.currentDistortion);
            }
            break;
          case 'phase':
            window.currentPhase = value;
            if (backgroundPhaseDisplay) backgroundPhaseDisplay.textContent = value;
            console.log(`🌊 Background phase updated to:`, value);
            if (window.backgroundControls.updateBackgroundPhase) {
              window.backgroundControls.updateBackgroundPhase(window.currentPhase);
            }
            break;
          case 'frequency':
            window.currentFrequency = value;
            if (backgroundFrequencyDisplay) backgroundFrequencyDisplay.textContent = value;
            console.log(`🌊 Background frequency updated to:`, value);
            if (window.backgroundControls.updateBackgroundFrequency) {
              window.backgroundControls.updateBackgroundFrequency(window.currentFrequency);
            }
            break;
        }
      } catch (error) {
        console.log('⚠️ Background controls not yet available:', error);
      }
    } else {
      console.log('⚠️ Background controls not ready yet');
      // Update display anyway for consistency
      switch(parameter) {
        case 'speed':
          if (backgroundSpeedDisplay) backgroundSpeedDisplay.textContent = value;
          break;
        case 'distortion':
          if (backgroundDistortionDisplay) backgroundDistortionDisplay.textContent = value;
          window.currentDistortion = value / 100.0;
          break;
          case 'phase':
          if (backgroundPhaseDisplay) backgroundPhaseDisplay.textContent = value;
          window.currentPhase = value;
          break;
        case 'frequency':
          if (backgroundFrequencyDisplay) backgroundFrequencyDisplay.textContent = value;
          window.currentFrequency = value;
          break;
      }
    }
  }

  // Function to update particles opacity
  function updateParticlesOpacity(opacityValue) {
    if (window.pJSDom && window.pJSDom.length > 0 && opacityDisplay) {
      opacityDisplay.textContent = opacityValue;
      updateParticlesParameter('opacity', opacityValue);
      console.log('✨ Particles opacity updated to:', opacityValue);
    } else {
      console.log('⚠️ Particles.js not ready yet, cannot update opacity');
      if (opacityDisplay) opacityDisplay.textContent = opacityValue;
    }
  }

  // Function to update particles color
  function updateParticlesColor(colorValue) {
    const colorDisplay = document.getElementById('particles-color-display');
    if (window.pJSDom && window.pJSDom.length > 0) {
      const pJS = window.pJSDom[0].pJS;
      if (pJS.particles.color) {
        pJS.particles.color.value = colorValue;
        if (typeof particlesJS === 'function') {
          pJS.fn.particlesEmpty();
          particlesJS("particles-js", {...pJS.particles});
        }
      }
    }
    if (colorDisplay) colorDisplay.textContent = colorValue;
    console.log('✨ Particles color updated to:', colorValue);
  }

  // Event listeners
  if (toggleBtn) {
    toggleBtn.addEventListener('click', function(e) {
      e.preventDefault();
      e.stopPropagation();
      toggleControlPanel();
    });
    console.log('✅ Toggle button event listener attached');
  }

  if (closeBtn) {
    closeBtn.addEventListener('click', function(e) {
      e.preventDefault();
      e.stopPropagation();
      hideControlPanel();
    });
    console.log('✅ Close button event listener attached');
  }

  // Tab event listeners
  if (particlesTab) {
    particlesTab.addEventListener('click', function(e) {
      e.preventDefault();
      switchTab('particles');
    });
    console.log('✅ Particles tab event listener attached');
  }

  if (backgroundTab) {
    backgroundTab.addEventListener('click', function(e) {
      e.preventDefault();
      switchTab('background');
    });
    console.log('✅ Background tab event listener attached');
  }

  // Slider event listeners
  if (numberSlider) {
    numberSlider.addEventListener('input', function(e) {
      const newValue = parseInt(e.target.value);
      updateParticlesParameter('number', newValue);
    });
    console.log('✅ Number slider event listener attached');
  }

  if (speedSlider) {
    speedSlider.addEventListener('input', function(e) {
      const newValue = parseFloat(e.target.value);
      updateParticlesParameter('speed', newValue);
    });
    console.log('✅ Speed slider event listener attached');
  }

  if (sizeSlider) {
    sizeSlider.addEventListener('input', function(e) {
      const newValue = parseInt(e.target.value);
      updateParticlesParameter('size', newValue);
    });
    console.log('✅ Size slider event listener attached');
  }

  if (opacitySlider) {
    opacitySlider.addEventListener('input', function(e) {
      const newValue = parseFloat(e.target.value);
      updateParticlesOpacity(newValue);
    });
    console.log('✅ Opacity slider event listener attached');
  }

  if (linkOpacitySlider) {
    linkOpacitySlider.addEventListener('input', function(e) {
      const newValue = parseFloat(e.target.value);
      updateParticlesParameter('linkOpacity', newValue);
    });
    console.log('✅ Link opacity slider event listener attached');
  }

  // Background slider event listeners
  if (backgroundSpeedSlider) {
    backgroundSpeedSlider.addEventListener('input', function(e) {
      const newValue = parseFloat(e.target.value);
      updateBackgroundParameter('speed', newValue);
    });
    console.log('✅ Background speed slider event listener attached');
  }

  if (backgroundDistortionSlider) {
    backgroundDistortionSlider.addEventListener('input', function(e) {
      const newValue = parseInt(e.target.value);
      updateBackgroundParameter('distortion', newValue);
    });
    console.log('✅ Background distortion slider event listener attached');
  }

  if (backgroundPhaseSlider) {
    backgroundPhaseSlider.addEventListener('input', function(e) {
      const newValue = parseFloat(e.target.value);
      updateBackgroundParameter('phase', newValue);
    });
    console.log('✅ Background phase slider event listener attached');
  }

  if (backgroundFrequencySlider) {
    backgroundFrequencySlider.addEventListener('input', function(e) {
      const newValue = parseFloat(e.target.value);
      updateBackgroundParameter('frequency', newValue);
    });
    console.log('✅ Background frequency slider event listener attached');
  }

  // Color picker event listener
  const colorPicker = document.getElementById('particles-color');
  if (colorPicker) {
    colorPicker.addEventListener('input', function(e) {
      const newColor = e.target.value;
      updateParticlesColor(newColor);
    });
    console.log('✅ Color picker event listener attached');
  }

  // Initialize global distortion value
  window.currentDistortion = 35 / 100.0;
  window.currentPhase = 0;
  window.currentFrequency = 1.0;

  // Global function for background.js
  window.updateBackgroundDistortion = function(distortionValue) {
    console.log('🌊 updateBackgroundDistortion called with:', distortionValue);
    window.currentDistortion = distortionValue;
    if (backgroundDistortionDisplay) {
      backgroundDistortionDisplay.textContent = (window.currentDistortion * 100).toFixed(0);
    }
    if (window.backgroundControls && typeof window.backgroundControls.setUniformValue === 'function') {
      window.backgroundControls.setUniformValue('u_distortion', distortionValue * 10.0);
    }
    return true;
  };

  // Close panel when clicking outside or pressing Escape
  document.addEventListener('keydown', function(e) {
    if (e.key === 'Escape' && !controlPanel.classList.contains('hidden')) {
      hideControlPanel();
    }
  });

  document.addEventListener('click', function(e) {
    if (!controlPanel.classList.contains('hidden') &&
        !controlPanel.contains(e.target) &&
        e.target !== toggleBtn) {
      hideControlPanel();
    }
  });

  // Initialize controls - wait for particles.js to be fully loaded
  let initAttempts = 0;
  const maxAttempts = 20;

  function tryInitialize() {
    initAttempts++;
    if (!initializeParticlesControls()) {
      if (initAttempts < maxAttempts) {
        setTimeout(tryInitialize, 100);
      } else {
        console.log('✨ Particles controls initialization timed out, but controls will work when particles.js loads');
      }
    }
  }

  setTimeout(tryInitialize, 500);
  console.log('✅ Minimal particles control panel initialized with full functionality');
});
</script>

<!-- Resume download -->
<script>
document.addEventListener('DOMContentLoaded', () => {
  const resumeLink = document.getElementById('resume-link');
  if (resumeLink) {
    resumeLink.addEventListener('click', (e) => {
      const link = document.createElement('a');
      link.href = './src/Uday_Lunawat_Resume_Senior_ML_Engineer_V9.pdf';
      link.download = 'Uday_Lunawat_Resume_Senior_ML_Engineer_V9.pdf';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    });
  }
});
</script></body>
</html>
