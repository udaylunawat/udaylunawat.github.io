<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Uday Lunawat - Portfolio</title>
    <!-- Critical CSS preload -->
    <link rel="preload" href="src/style.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="src/style.css"></noscript>

    <!-- Preconnect to external resources -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>

    <!-- Font loading optimization - async loading -->
    <link rel="preload" href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;200;300;400;500;600;700;800;900&family=Oswald:wght@200;300;400;500;600;700&family=Roboto+Mono:ital,wght@0,100;0,200;0,300;0,400;1,100;1,200;1,300;1,400&display=swap" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@100;200;300;400;500;600;700;800;900&family=Oswald:wght@200;300;400;500;600;700&family=Roboto+Mono:ital,wght@0,100;0,200;0,300;0,400;1,100;1,200;1,300;1,400&display=swap" rel="stylesheet"></noscript>

    <!-- Icons stylesheet -->
    <link rel="preload" href="https://cdn.jsdelivr.net/gh/devicons/devicon@v2.15.1/devicon.min.css" as="style" onload="this.onload=null;this.rel='stylesheet'">
    <noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/devicons/devicon@v2.15.1/devicon.min.css"></noscript>

    <!-- Critical JavaScript resources -->
    <link rel="preload" href="./src/navigation.js" as="script" crossorigin>
    <link rel="preload" href="./src/modals.js" as="script" crossorigin>
    <link rel="preload" href="./src/scroll-animations.js" as="script" crossorigin>
    <link rel="preload" href="./src/particles-config.js" as="script" crossorigin>
    <link rel="preload" href="./src/particles-controls.js" as="script" crossorigin>
    <!-- Prevent brief flash of navigation, modals and control UI before CSS/JS initialise -->
<style>
  /* Hide potentially flashing UI until we explicitly reveal it */
  body:not(.show-ui) .main-nav,
  body:not(.show-ui) .nav-open-icon,
  body:not(.show-ui) .nav-close-icon,
  body:not(.show-ui) #experience-modal,
  body:not(.show-ui) #project-modal,
  body:not(.show-ui) .particles-control-toggle-btn,
  body:not(.show-ui) .particles-control-panel {
    opacity: 0 !important;
    visibility: hidden !important;
    pointer-events: none !important;
  }
    /* Base background is dark even before CSS file loads */
  body {
    background: #000;
  }

  /* Before the app is ready, show only the loader, hide everything else */
  body:not(.show-ui) > :not(.ai-loader) {
    opacity: 0 !important;
    visibility: hidden !important;
    pointer-events: none !important;
  }
</style>
<script>
  (function() {
    const MIN_LOADER_TIME = 5000;   // 5000 ms = 5 seconds minimum
    const MAX_LOADER_TIME = 8000;   // hard safety cap
    const startTime = performance.now ? performance.now() : Date.now();

    function reveal() {
      try {
        document.body.classList.add('show-ui');
      } catch (e) {}
    }

    // When the page finishes loading, wait until we've hit MIN_LOADER_TIME
    window.addEventListener('load', function onLoad() {
      const now = performance.now ? performance.now() : Date.now();
      const elapsed = now - startTime;
      const remaining = Math.max(0, MIN_LOADER_TIME - elapsed);
      setTimeout(reveal, remaining);
      window.removeEventListener('load', onLoad);
    }, { once: true });

    // Absolute fallback in case 'load' never fires or something hangs
    setTimeout(reveal, MAX_LOADER_TIME);
  })();
</script>
</head>

<body>
<!-- Minimal AMOLED neural loader -->
<div class="ai-loader" id="ai-loader">
  <div class="ai-loader-inner">
    <div class="ai-grid">
      <div class="ai-grid-nodes" id="ai-grid-nodes">
        <!-- 16 nodes -->
        <div class="ai-node-dot"></div>
        <div class="ai-node-dot"></div>
        <div class="ai-node-dot"></div>
        <div class="ai-node-dot"></div>
        <div class="ai-node-dot"></div>
        <div class="ai-node-dot"></div>
        <div class="ai-node-dot"></div>
        <div class="ai-node-dot"></div>
        <div class="ai-node-dot"></div>
        <div class="ai-node-dot"></div>
        <div class="ai-node-dot"></div>
        <div class="ai-node-dot"></div>
        <div class="ai-node-dot"></div>
        <div class="ai-node-dot"></div>
        <div class="ai-node-dot"></div>
        <div class="ai-node-dot"></div>
      </div>
      <div class="ai-grid-scan"></div>
    </div>

    <div class="ai-loader-text">
      <div>
        <div class="ai-chipline">
          <div class="ai-chip">
            <span class="ai-chip-dot"></span>
            <span>ai session</span>
          </div>
          <span>neural portfolio</span>
        </div>
        <div class="ai-name">Uday Lunawat</div>
        <div class="ai-role">Senior ML Engineer Â· LLMs Â· Agents Â· RAG</div>
      </div>

      <div class="ai-status-line">
        <span class="ai-status-tag">BOOT</span>
        <span id="ai-loader-status">linking workspace graph</span>
      </div>

      <div class="ai-progress-row">
        <div class="ai-progress-bar">
          <div class="ai-progress-fill"></div>
        </div>
        <div class="ai-progress-percent" id="ai-loader-percent">98.4%</div>
      </div>

      <div class="ai-hints">
        <span>hint</span>
        <code id="ai-loader-hint">hydrating /skills vector space</code>
      </div>
    </div>
  </div>
</div>
<div class="canvas-container" id="canvas">
<!-- <div id="brain-name">Uday Lunawat</div> -->
</div>
<div id="particles-js"></div>

<div class="color-background" id="colorBackground">
</div>

<!-- Minimal Particles Control Panel Toggle Button -->
<button id="particles-control-toggle" class="particles-control-toggle-btn" title="Particles Controls">
  âœ¨
</button>

<!-- Minimal Particles Control Panel with Tabs -->
<div id="particles-control-panel" class="particles-control-panel hidden">
  <div class="particles-panel-header">
    <h3>ðŸŽ® Controls</h3>
    <button id="particles-panel-close" class="particles-panel-close">&times;</button>
  </div>

  <!-- Tab Navigation -->
  <div class="control-tabs">
    <button id="particles-tab" class="control-tab active" data-tab="particles">âœ¨ Particles</button>
    <button id="background-tab" class="control-tab" data-tab="background">ðŸŒŠ Background</button>
  </div>

  <!-- Particles Tab Content -->
  <div id="particles-content" class="particles-panel-content control-tab-panel active">
    <div class="control-group">
      <label>Particle Count</label>
      <div class="single-control">
        <input type="range" id="particles-number" min="1" max="100" value="15" step="1">
        <span id="particles-number-display" class="value-display">15</span>
      </div>
    </div>

    <div class="control-group">
      <label>Particle Speed</label>
      <div class="single-control">
        <input type="range" id="particles-speed" min="0.5" max="10" value="3" step="0.5">
        <span id="particles-speed-display" class="value-display">3</span>
      </div>
    </div>

    <div class="control-group">
      <label>Particle Size</label>
      <div class="single-control">
        <input type="range" id="particles-size" min="2" max="20" value="8" step="1">
        <span id="particles-size-display" class="value-display">8</span>
      </div>
    </div>

    <div class="control-group">
      <label>Particle Opacity</label>
      <div class="single-control">
        <input type="range" id="particles-opacity" min="0.1" max="1.0" value="1.0" step="0.05">
        <span id="particles-opacity-display" class="value-display">1.0</span>
      </div>
    </div>

    <div class="control-group">
      <label>Link Opacity</label>
      <div class="single-control">
        <input type="range" id="particles-link-opacity" min="0.1" max="1.0" value="0.4" step="0.05">
        <span id="particles-link-opacity-display" class="value-display">0.4</span>
      </div>
    </div>

    <div class="control-group">
      <label>Particle Color</label>
      <div class="single-control color-control">
        <input type="color" id="particles-color" value="#ffffff" class="color-picker">
        <span id="particles-color-display" class="value-display">#ffffff</span>
      </div>
    </div>
  </div>

  <!-- Background Tab Content -->
  <div id="background-content" class="particles-panel-content control-tab-panel">
    <div class="control-info">
      <p>ðŸŽ¨ Background animation controls</p>
    </div>

    <div class="control-group">
      <label>Animation Speed</label>
      <div class="single-control">
        <input type="range" id="background-speed" min="0.001" max="0.5" value="0.01" step="0.001">
        <span id="background-speed-display" class="value-display">0.01</span>
      </div>
    </div>

    <div class="control-group">
      <label>Distortion</label>
      <div class="single-control">
        <input type="range" id="background-distortion" min="0" max="100" value="35" step="1">
        <span id="background-distortion-display" class="value-display">35</span>
      </div>
    </div>

    <div class="control-group">
      <label>Wave Frequency</label>
      <div class="single-control">
        <input type="range" id="background-frequency" min="0.5" max="2.0" value="1.0" step="0.1">
        <span id="background-frequency-display" class="value-display">1.0</span>
      </div>
    </div>

    <div class="control-group">
      <label>Animation Phase</label>
      <div class="single-control">
        <input type="range" id="background-phase" min="0" max="6.28" value="0" step="0.1">
        <span id="background-phase-display" class="value-display">0</span>
      </div>
    </div>
  </div>
</div>

<nav class="main-nav" id="menu">
    <img class="nav-close-icon" id="close-icon" src="./src/img/close-icon.svg" alt="" onclick="hideMenu()">
    <ul>
        <li><a href="#homeTitle" onclick="hideMenu()">Home</a></li>
        <li><a href="#about" onclick="hideMenu()">About</a></li>
        <li><a href="#credentials" onclick="hideMenu()">Experience</a></li>
        <li><a href="#skills" onclick="hideMenu()">Skills</a></li>
        <li><a href="#projects" onclick="hideMenu()">Projects</a></li>
        <li><a href="#contact" onclick="hideMenu()">CONTAct /<span>resume</span></a></li>
    </ul>
</nav>

<!----------- HOME -------->

<header class="home" id="homeTitle">
    <div class="wrapper">
      <div class="home-grid">
        <h4 id="homeTitle1">Loading...</h4>
        <svg width="18.75rem" height="6.25rem">
          <line x1="9.375rem" y1="6.25rem" x2="9.375rem" y2="0" stroke="#ffffff37"/>
          <line x1="6.25rem" y1="3.125rem" x2="12.5rem" y2="3.125rem" stroke="#ffffff37"/>
        </svg>
        <h4 id="homeTitle2">Loading...</h4>
      </div>
      <h2 id="homeName">Uday Lunawat</h2>
      <p class="tagline">Loading...</p>
    </div>
  </header>

<!--------- ABOUT ---------->

<section class="about" id="about">
    <div class="wrapper">
      <div class="text-box">
        <h2>
          <img src="./src/img/icon-rocket.svg" alt="Rocket icon">
          Passion
        </h2>
        <p>
          Loading...
        </p>
      </div>
    </div>
  </section>

  <section class="credentials" id="credentials">
    <div class="wrapper">
      <h2>Experience</h2>

      <!-- Experience Gallery -->
      <div class="experience-gallery">
        <div class="gallery-container">
          <div class="gallery-grid" id="experience-gallery-grid">
            <!-- Content will be loaded dynamically from content.json -->
          </div>
        </div>
      </div>
    </div>
  </section>

<!--------- SKILLS ---------->
<section class="skills" id="skills">
  <h2>Skills</h2>
  <div class="brain-host" id="brain-host"></div>
  <noscript>
    <p>Please enable JavaScript to view the interactive skills brain.</p>
  </noscript>
</section>

<!-------- PROJECTS -------->

<section class="projects" id="projects">
    <div class="wrapper">
      <h2>Projects</h2>

      <!-- Infinite Scroll Gallery -->
      <div class="infinite-gallery">
        <div class="gallery-container">
          <div class="gallery-grid" id="gallery-grid">
            <!-- Content will be loaded dynamically from projects.json -->
          </div>
        </div>

        <!-- Loading indicator -->
        <div class="loading-indicator" id="loading-indicator">
          <div class="loading-spinner"></div>
          <p>Loading more projects...</p>
        </div>
      </div>
    </div>
  </section>

<!------------ CONTACT ------------->

<section class="contact" id="contact">
    <h2>Contact</h2>
    <div class="wrapper">
      <div class="flex-container">
        <div class="flex-container">
<div class="img-container">
            <img src="./src/img/uday.webp" alt="Loading..." class="profile-photo">
          </div>
          <div class="contact-col">
            <p>
              Senior Machine Learning Engineer with experience in developing and deploying AI solutions for various industries. Passionate about using AI to solve real-world problems and create innovative products.
            </p>
            <div class="flex-container">
              <a href="https://www.linkedin.com/in/udaylunawat/"><button class="secondary-btn">LinkedIn</button></a>
              <a href="https://github.com/udaylunawat"><button class="secondary-btn">GitHub</button></a>
              <a href="https://twitter.com/UdayLunawat"><button class="secondary-btn">Twitter</button></a>
            </div>

            <div style="margin-top:12px;">
              <a href="#" id="resume-link">
                <button>
                  DOWNLOAD RESUME
                  <img src="./src/img/pdf-icon.svg" alt="">
                </button>
              </a>
            </div>
          </div>
        </div>

        <div class="contact-form-container contact-col">
          <h4>Contact Me</h4>
          <div class="contact-form">
            <form
            action="https://formspree.io/f/mvgbvdbq"
            method="POST"
          >
            <label>
              Your email:
              <input type="email" name="email">
            </label>
            <label>
              Your message:
              <textarea name="message"></textarea>
            </label>
            <!-- your other form fields go here -->
            <button type="submit">Send</button>
          </form>
          </div>
        </div>

      </div>
    </div>
  </section>

<!------------ FOOTER ------------->

<!-- <section class="footer">
</section> -->

<!-- Modal system integrated -->
<div id="project-modal" class="modal-overlay">
  <div class="modal-content">
    <div class="modal-content-wrapper">
      <div class="modal-header">
        <div class="modal-header-content">
          <h1 id="modal-title">Project Title</h1>
          <div class="tags" id="modal-tags"></div>
        </div>
      </div>
      <div class="modal-body">
        <div id="modal-content-container" class="blog-content">
          <!-- Project content will be loaded here -->
        </div>
      </div>
    </div>
  </div>
</div>

<div id="experience-modal" class="modal-overlay">
  <div class="modal-content">
    <div class="modal-content-wrapper">
      <div class="modal-header">
        <div class="modal-header-content">
          <h1 id="experience-modal-title">Experience Title</h1>
          <div class="tags" id="experience-modal-tags"></div>
        </div>
      </div>
      <div class="modal-body">
        <div id="experience-modal-content-container" class="blog-content">
          <!-- Experience content will be loaded here -->
        </div>
      </div>
    </div>
  </div>
</div>

<!------------ NAVIGATION ------------->

<img class="nav-open-icon" id="open-icon" src="./src/img/menu-icon.svg" alt="" onclick="showMenu()">

<script src="./src/navigation.js" type="module"></script>
<script src="./src/modals.js" type="module"></script>

<!-- Core dependencies -->
<script src="https://cdn.jsdelivr.net/particles.js/2.0.0/particles.min.js" defer></script>

<!-- Particles configuration (must load before scroll-animations.js) -->
<script src="./src/particles-config.js" defer></script>

<!-- Matrix effect for skills section -->
<script src="./src/matrix-effect.js" defer></script>

<script src="./src/scroll-animations.js" type="module"></script>

<!-- Shaders for animated background (required by background.js) -->
<script id="snoise-function" type="x-shader/x-vertex">
    vec3 mod289(vec3 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }
    vec2 mod289(vec2 x) { return x - floor(x * (1.0 / 289.0)) * 289.0; }
    vec3 permute(vec3 x) { return mod289(((x*34.0)+1.0)*x); }

    float snoise(vec2 v) {
        const vec4 C = vec4(0.211324865405187,  // (3.0-sqrt(3.0))/6.0
                            0.366025403784439,  // 0.5*(sqrt(3.0)-1.0)
                            -0.577350269189626,  // -1.0 + 2.0 * C.x
                            0.024390243902439); // 1.0 / 41.0
        vec2 i  = floor(v + dot(v, C.yy) );
        vec2 x0 = v -   i + dot(i, C.xx);
        vec2 i1;
        i1 = (x0.x > x0.y) ? vec2(1.0, 0.0) : vec2(0.0, 1.0);
        vec4 x12 = x0.xyxy + C.xxzz;
        x12.xy -= i1;
        i = mod289(i); // Avoid truncation effects in permutation
        vec3 p = permute( permute( i.y + vec3(0.0, i1.y, 1.0 ))
            + i.x + vec3(0.0, i1.x, 1.0 ));

        vec3 m = max(0.5 - vec3(dot(x0,x0), dot(x12.xy,x12.xy), dot(x12.zw,x12.zw)), 0.0);
        m = m*m ;
        m = m*m ;
        vec3 x = 2.0 * fract(p * C.www) - 1.0;
        vec3 h = abs(x) - 0.5;
        vec3 ox = floor(x + 0.5);
        vec3 a0 = x - ox;
        m *= 1.79284291400159 - 0.85373472095314 * ( a0*a0 + h*h );
        vec3 g;
        g.x  = a0.x  * x0.x  + h.x  * x0.y;
        g.yz = a0.yz * x12.xz + h.yz * x12.yw;
        return 130.0 * dot(m, g);
    }
</script>
<script id="vertex-shader" type="x-shader/x-vertex">
    uniform float u_time;
    uniform vec2 u_randomisePosition;
    uniform float u_distortion;

    varying float vDistortion;
    varying float xDistortion;
    varying vec2 vUv;

    void main() {
        vUv = uv;
        vDistortion = snoise(vUv.xx * u_distortion * 0.3 - u_randomisePosition * 0.15);
        xDistortion = snoise(vUv.yy * u_distortion * 0.1 - u_randomisePosition * 0.05);
        vec3 pos = position;
        pos.z += (vDistortion * u_distortion * 3.5);
        pos.x += (xDistortion * u_distortion * 2.5);

        gl_Position = projectionMatrix * modelViewMatrix * vec4(pos, 1.0);
    }
</script>
<script id="fragment-shader" type="x-shader/x-fragment">
    vec3 rgb(float r, float g, float b) {
        return vec3(r / 255., g / 255., b / 255.);
    }

    vec3 rgb(float c) {
        return vec3(c / 255., c / 255., c / 255.);
    }

    uniform vec3 u_bg;
    uniform vec3 u_bgMain;
    uniform vec3 u_color1;
    uniform vec3 u_color2;
    uniform float u_time;

    varying vec2 vUv;
    varying float vDistortion;

    void main() {
        vec3 bg = rgb(u_bg.r, u_bg.g, u_bg.b);
        vec3 c1 = rgb(u_color1.r, u_color1.g, u_color1.b);
        vec3 c2 = rgb(u_color2.r, u_color2.g, u_color2.b);
        vec3 bgMain = rgb(u_bgMain.r, u_bg.g, u_bg.b);

        float noise1 = snoise(vUv + u_time * 0.08);
        float noise2 = snoise(vUv * 2. + u_time * 0.1);

        vec3 color = bg;
        color = mix(color, c1, noise1 * 0.6);
        color = mix(color, c2, noise2 * .4);

        color = mix(color, mix(c1, c2, vUv.x), vDistortion);

        float border = smoothstep(0.1, 0.6, vUv.x);

        color = mix(color, bgMain, 1. -border);

        gl_FragColor = vec4(color, 1.0);
    }
</script>

<script src="./src/background.js" type="module"></script>
<!-- Tag cloud + tilt libraries (used by Skills UI) -->
<script src="https://cdn.jsdelivr.net/npm/tagcloud@2.2.0/dist/TagCloud.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/vanilla-tilt@1.7.3/dist/vanilla-tilt.min.js"></script>
<script src="./src/content-loader.js"></script>

<!-- Three UMD + helpers (same version) -->
<script src="https://unpkg.com/three@0.128.0/build/three.min.js"></script>
<script src="https://unpkg.com/three@0.128.0/examples/js/loaders/GLTFLoader.js"></script>
<script src="https://unpkg.com/three@0.128.0/examples/js/utils/BufferGeometryUtils.js"></script>
<script src="https://unpkg.com/three@0.128.0/examples/js/modifiers/SimplifyModifier.js"></script>
<script type="module" src="./src/brainSkills.boot.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@500;600&display=swap" rel="stylesheet" />

<!-- Utility functions -->
<script src="./src/utils.js" defer></script>

<!-- Particles configuration -->
<script src="./src/particles-config.js" defer></script>

<!-- Live GitHub stars fetcher -->
<script src="./src/github-stars.js" defer></script>

<!-- Particles controls -->
<script src="./src/particles-controls.js" defer></script>

<!-- Resume download -->
<script>
document.addEventListener('DOMContentLoaded', () => {
  const resumeLink = document.getElementById('resume-link');
  if (resumeLink) {
    resumeLink.addEventListener('click', (e) => {
      const link = document.createElement('a');
      link.href = './src/Uday_Lunawat_Resume_Senior_ML_Engineer_V9.pdf';
      link.download = 'Uday_Lunawat_Resume_Senior_ML_Engineer_V9.pdf';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    });
  }
});

  // Tap to activate neon for ~1.2s
  document.addEventListener('touchstart', (e) => {
    const el = e.target.closest('.brain-chip, .brain-cluster h4');
    if (!el) return;
    el.classList.add('is-active');
    setTimeout(() => el.classList.remove('is-active'), 1200);
  }, { passive: true });

  // /* Reveal UI only after the page is fully loaded (and as a safety fallback after 3s).
  //    This prevents flashes where the nav or modals briefly appear before styles/scripts run. */
  // (function() {
  //   function reveal() { try { document.body.classList.add('show-ui'); } catch (e) {} }
  //   if (document.readyState === 'complete') reveal();
  //   else window.addEventListener('load', reveal, { once: true });
  //   // Fallback: ensure UI shows even if load hangs for some reason
  //   setTimeout(reveal, 3000);
  // })();
</script>
<!-- <script>
document.addEventListener('DOMContentLoaded', () => {
  const resumeLink = document.getElementById('resume-link');
  if (resumeLink) {
    resumeLink.addEventListener('click', (e) => {
      const link = document.createElement('a');
      link.href = './src/Uday_Lunawat_Resume_Senior_ML_Engineer_V9.pdf';
      link.download = 'Uday_Lunawat_Resume_Senior_ML_Engineer_V9.pdf';
      document.body.appendChild(link);
      link.click();
      document.body.removeChild(link);
    });
  }
});

// Tap to activate neon for ~1.2s
document.addEventListener('touchstart', (e) => {
  const el = e.target.closest('.brain-chip, .brain-cluster h4');
  if (!el) return;
  el.classList.add('is-active');
  setTimeout(() => el.classList.remove('is-active'), 1200);
}, { passive: true });
</script> -->
<script>

  // Minimal neural loader logic
  const statusEl = document.getElementById('ai-loader-status');
  const percentEl = document.getElementById('ai-loader-percent');
  const hintEl = document.getElementById('ai-loader-hint');
  const grid = document.getElementById('ai-grid-nodes');
  const dots = grid ? Array.from(grid.querySelectorAll('.ai-node-dot')) : [];

  const statuses = [
    'linking workspace graph',
    'mounting llm cores',
    'warming attention heads',
    'hydrating vector memory',
    'syncing /projects manifest',
    'initializing agent runtime'
  ];

  const hints = [
    'loading /about/uday',
    'compiling /experience timeline',
    'indexing /skills/brain space',
    'deploying /agents/vegas',
    'refreshing /projects/llm-lab',
    'arming /contact handshake'
  ];

  let statusIndex = 0;

  function updateStatus() {
    if (!statusEl) return;
    statusEl.textContent = statuses[statusIndex];
    statusIndex = (statusIndex + 1) % statuses.length;
  }

  function updateHint() {
    if (!hintEl) return;
    const value = hints[Math.floor(Math.random() * hints.length)];
    hintEl.textContent = value;
  }

  function randomInt(max) {
    return Math.floor(Math.random() * max);
  }

  function animateGrid() {
    if (!dots.length) return;
    dots.forEach(d => d.classList.remove('active'));
    const activeCount = 4 + randomInt(5); // 4 to 8 nodes
    for (let i = 0; i < activeCount; i++) {
      const idx = randomInt(dots.length);
      dots[idx].classList.add('active');
    }
  }

  updateStatus();
  updateHint();
  animateGrid();

  const statusTimer = setInterval(updateStatus, 1200);
  const hintTimer = setInterval(updateHint, 2600);
  const gridTimer = setInterval(animateGrid, 260);

  let pctTimer = null;
  if (percentEl) {
    let pct = 94 + Math.random() * 3;
    pctTimer = setInterval(() => {
      pct += Math.random() * 1.2;
      if (pct > 99.4) {
        pct = 96.5 + Math.random() * 2.5;
      }
      percentEl.textContent = pct.toFixed(1) + '%';
    }, 420);
  }

  function stopLoaderTimers() {
    clearInterval(statusTimer);
    clearInterval(hintTimer);
    clearInterval(gridTimer);
    if (pctTimer) clearInterval(pctTimer);
  }

  // Stop loader animations once UI is revealed
  const observer = new MutationObserver(() => {
    if (document.body.classList.contains('show-ui')) {
      stopLoaderTimers();
      observer.disconnect();
    }
  });

  observer.observe(document.body, { attributes: true, attributeFilter: ['class'] });
</script>
</body>
</html>
